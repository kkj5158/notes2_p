## 목차
[[1_재고시스템 만들어보기_문제점]]
[[2_재고시스템 만들어보기_해결]]
[[3_재고시스템 만들어보기 _ 분산환경 _ DB에서의 동시성처리]]
# Pessimistic Lock (비관적 락)활용
> 비관적 락은 Repeatable Read 또는 Serializable 정도의 격리성 수준을 제공한다.

트랜잭션이 시작될 때 Shared Lock 또는 Exclusive Lock을 걸고 시작한다.

- **`공유락 (Shared Lock)`** : Read Lock이라고도 불리는 공유락은 트랜잭션이 읽기를 할 때 사용하는 락이며, 데이터를 읽기만하기 때문에 같은 공유락끼리는 동시에 접근이 가능하지만, write 작업은 막는다.
    
- **`배타락 (Exclusive Lock)`** : Write Lock이라고도 불리며, 데이터를 변경할 때 사용하는 락이다. 트랜잭션이 완료될 때까지 유지되며, 배타락이 끝나기 전까지 read/write를 모두 막는다.


# Optimistic Lock (낙관적 락)활용

낙관적 락은 수정할 때 **수정했다고 명시**하여 **다른 트랜잭션이 동일한 조건으로 값을 수정할 수 없게 하는 것**이다.

- 낙관적 락은 version과 같은 **별도의 컬럼을 추가**하여 충돌 발생을 막는다.
    
    일반적으로 `version(hashcode/timestamp를 사용할 수도 있다)`의 상태를 보고 **충돌을 확인**한다.  
      
    
- 충돌이 발생했을때, **DB가 아닌 애플리케이션 단에서 처리** 한다.
    
    낙관적 락은 UPDATE에 실패해도 자동으로 예외를 던지지 않고, 단순히 0개의 row를 업데이트 한다. 따라서 이때 여러 작업이 묶인 트랜잭션 요청이 실패할 경우, `개발자가 직접 롤백 처리`를 해줘야 한다.



# Named Lock (분산 락)활용